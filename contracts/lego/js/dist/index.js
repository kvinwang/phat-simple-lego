(()=>{"use strict";var __webpack_modules__={730:(e,t)=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}var __webpack_exports__={};(()=>{var _phala_pink_env__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(730);function doEval(script,input,context){function numToUint8Array32(e){let t=new Uint8Array(32);for(let r=0;r<32;r++)t[r]=e%256,e=Math.floor(e/256);return t}return eval(script)}function hex(e){return"0x"+Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("")}function replaceBnWzStr(e){if("bigint"==typeof e)return e.toString();if(e instanceof Uint8Array)return hex(e);if(Array.isArray(e))return e.map((e=>replaceBnWzStr(e)));if("object"==typeof e&&null!==e){const t={};for(const[r,n]of Object.entries(e))t[r]=replaceBnWzStr(n);return t}return e}function repr(e){try{return JSON.stringify(replaceBnWzStr(e))}catch(t){return e}}!function(){const e=globalThis.pink,t=e.SCALE;function r(r,n,o){switch(n.cmd){case"call":return function(r,n,o){const c=r.config,u=r.config.codec;void 0!==u?.inputs&&(n=function(e,r,n){return t.codec(r,n).encode(e)}(n,u.inputs,o),debugWorkflow&&console.log(`encoded call input: ${hex(n)}`));let i=e.invokeContract({...c,input:n});return debugWorkflow&&console.log(`call output: ${repr(i)}`),void 0!==u?.output&&(i=function(e,r,n){return t.codec(r,n).decode(e)}(i,u.output,o)),i}(n,o,r.typeRegistry);case"eval":return function(e,t,r){const n=e.config;if("string"!=typeof n)throw new Error("Trying to eval non-string");return doEval(n,t,r)}(n,o,r);case"fetch":return function(t,r){let n;n="string"==typeof t.config?{url:t.config}:t.config;let o={};"string"!=typeof r&&"object"!=typeof r||(o="string"==typeof r&&r.length>0?{url:r}:r),o={...n,...o};const{url:c,method:u,headers:i,body:s,returnTextBody:a}=o;if("string"!=typeof c)throw new Error("invalid url");const l=e.httpRequest({url:c,method:u,headers:i,body:s,returnTextBody:a});if(!o.allowNon2xx&&(l.statusCode<200||l.statusCode>=300))throw new Error(`http request failed: ${l.statusCode}`);return l}(n,o);case"scale":return function(e,r,n){const{subcmd:o,type:c}=e.config,u=t.codec(c,n);if("encode"===o)return u.encode(r);if("decode"===o)return u.decode(r);throw new Error(`unknown scale subcmd: ${o}`)}(n,o,r.typeRegistry);case"log":return o;default:throw new Error(`unknown action: ${n.cmd}`)}}!function(e){const n=JSON.parse(e),o=n.version;if(globalThis.debugWorkflow=n.debug||!1,1!==o)throw new Error(`unsupported workflow version: ${o}`);const c=n.actions;let u="",i={typeRegistry:t.parseTypes(n.types)};for(let e=0;e<c.length;e++){const t=c[e];void 0!==t.input&&(u=t.input);const n=t.name??t.cmd;debugWorkflow&&console.log(`running action [${n}], ${t.cmd}(input=${repr(u)})`);const o=r(i,t,u);u=o,t.name?.length>0&&(i[n]={output:o})}}(scriptArgs[0]),console.log("workflow done")}()})()})();